<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ì„¸ì¢…ê²½ì°° í†µí•©ê´€ì œ (Shelter v2)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root {
            --bg: #000000; --card: #1c1c1e; --text: #ffffff; --sub: #8e8e93;
            --line: #2c2c2e; --blue: #0a84ff; --red: #ff453a; --green: #30d158; --orange: #ff9f0a;
        }
        body {
            background: var(--bg); color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Pretendard", sans-serif;
            margin: 0; padding: env(safe-area-inset-top) 20px 40px 20px;
            -webkit-tap-highlight-color: transparent; user-select: none;
        }
        header { margin-bottom: 10px; }
        .top-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        h1 { margin: 0; font-size: 20px; font-weight: 700; }

        /* ì•„ì½”ë””ì–¸ */
        .accord-section { background: #2c2c2e; border: 1px solid var(--line); border-radius: 16px; overflow: hidden; margin-bottom: 15px; }
        .accord-header { background: #3a3a3c; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .ah-title { font-size: 14px; font-weight: 700; display: flex; align-items: center; gap: 8px; color: #fff; }
        .accord-content { display: none; padding: 15px; }
        .accord-section.open .accord-content { display: block; }

        /* ëŒ€í”¼ì†Œ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .shelter-container { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .shelter-card {
            background: #1c1c1e; padding: 12px; border-radius: 12px;
            border: 1px solid var(--line); display: flex; flex-direction: column; gap: 5px;
        }
        .shelter-name { font-size: 13px; font-weight: 700; color: #fff; word-break: keep-all; }
        .shelter-info { font-size: 11px; color: var(--sub); line-height: 1.4; }
        .shelter-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-bottom: 4px; }
        .tag-blue { background: rgba(10, 132, 255, 0.2); color: var(--blue); }
        .shelter-detail { margin-top: 5px; padding-top: 5px; border-top: 1px solid #333; font-size: 10px; color: #aaa; }
        .tel-link { color: var(--green); text-decoration: none; font-weight: bold; }

        /* í•„í„° ë²„íŠ¼ */
        .filter-group { display: flex; gap: 5px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 10px; }
        .filter-btn { background: #2c2c2e; border: 1px solid #444; color: #888; padding: 6px 12px; border-radius: 15px; font-size: 11px; white-space: nowrap; }
        .filter-btn.active { background: var(--blue); color: white; border-color: var(--blue); }

        /* ê³µí†µ UI */
        .sejong-summary { font-size: 12px; background: rgba(0,0,0,0.3); padding: 4px 8px; border-radius: 6px; color: var(--green); }
        .rain-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background: #444; border: 1px solid #444; }
        .rain-cell { background: #1c1c1e; padding: 8px 2px; text-align: center; font-size: 11px; }
        #sync-status { position: fixed; bottom: 10px; right: 10px; font-size: 10px; color: #444; }
    </style>
</head>
<body>

<header>
    <div class="top-nav">
        <h1>ì„¸ì¢…ê²½ì°° í†µí•©ê´€ì œ</h1>
        <button id="admin-btn" style="background:none; border:1px solid #444; color:#888; padding:5px 10px; border-radius:15px; font-size:11px;" onclick="toggleAdmin()">ğŸ”’ ê´€ë¦¬ì</button>
    </div>
</header>

<div class="accord-section" id="sec-weather">
    <div class="accord-header" onclick="toggleSection('sec-weather')">
        <div class="ah-title"><i class="fas fa-tower-broadcast"></i> ê¸°ìƒíŠ¹ë³´</div>
        <div id="sejong-status" class="sejong-summary">íŠ¹ë³´ ì—†ìŒ</div>
    </div>
    <div class="accord-content" id="monitor-content"></div>
</div>

<div class="accord-section" id="sec-rain">
    <div class="accord-header" onclick="toggleSection('sec-rain')">
        <div class="ah-title"><i class="fas fa-cloud-showers-heavy"></i> ì§€ì—­ë³„ ê°•ìš°ëŸ‰</div>
    </div>
    <div class="accord-content">
        <div id="rain-grid" class="rain-grid"></div>
    </div>
</div>

<div class="accord-section open" id="sec-shelter">
    <div class="accord-header" onclick="toggleSection('sec-shelter')">
        <div class="ah-title"><i class="fas fa-house-chimney-user"></i> ì„ì‹œì£¼ê±°(ëŒ€í”¼) ì‹œì„¤</div>
        <div style="font-size:11px; color:var(--blue);">ì´ 69ê°œì†Œ</div>
    </div>
    <div class="accord-content">
        <div class="filter-group">
            <button class="filter-btn active" onclick="filterShelter('ì „ì²´', this)">ì „ì²´</button>
            <button class="filter-btn" onclick="filterShelter('ì¡°ì¹˜ì›', this)">ì¡°ì¹˜ì›</button>
            <button class="filter-btn" onclick="filterShelter('ì—°ì„œ', this)">ì—°ì„œë©´</button>
            <button class="filter-btn" onclick="filterShelter('ì „ì˜', this)">ì „ì˜ë©´</button>
            <button class="filter-btn" onclick="filterShelter('ì „ë™', this)">ì „ë™ë©´</button>
            <button class="filter-btn" onclick="filterShelter('ì†Œì •', this)">ì†Œì •ë©´</button>
            <button class="filter-btn" onclick="filterShelter('ë¶€ê°•', this)">ë¶€ê°•ë©´</button>
            <button class="filter-btn" onclick="filterShelter('ì—°ë™', this)">ì—°ë™ë©´</button>
        </div>
        <div id="shelter-list" class="shelter-container">
            </div>
    </div>
</div>

<div id="sync-status">â— Firebase Online</div>

<script>
    // 1. ëŒ€í”¼ì†Œ í†µí•© ë°ì´í„° (ì´ë¯¸ì§€ 1~4ë²ˆ ê¸°ë°˜)
    const shelterData = [
        { id:1, area:'ì¡°ì¹˜ì›', name:'ì¡°ì¹˜ì›ìë³µí•©ì»¤ë®¤ë‹ˆí‹°ì„¼í„°', addr:'ì¡°ì¹˜ì›ì ëŒ€ì²©ë¡œ 76', cap:162, earthquake:'O', tel:'044-301-5067' },
        { id:2, area:'ì¡°ì¹˜ì›', name:'ì¡°ì¹˜ì›ìì‚¬ë¬´ì†Œ', addr:'ì¡°ì¹˜ì›ì ìƒˆë‚´16ê¸¸ 17', cap:63, earthquake:'O', tel:'044-301-5172' },
        { id:3, area:'ì¡°ì¹˜ì›', name:'êµë™ì´ˆë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ìƒˆë‚´18ê¸¸ 21', cap:417, earthquake:'O', tel:'044-902-4800' },
        { id:4, area:'ì¡°ì¹˜ì›', name:'ëŒ€ë™ì´ˆë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ëŒ€ë™í•™êµê¸¸ 11', cap:465, earthquake:'O', tel:'044-862-4605' },
        { id:5, area:'ì¡°ì¹˜ì›', name:'ëª…ë™ì´ˆë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ìƒˆë‚´8ê¸¸ 115', cap:177, earthquake:'O', tel:'044-865-2245' },
        { id:6, area:'ì¡°ì¹˜ì›', name:'ì„¸ì¢…ì—¬ìê³ ë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ë´‰ì‚°ë¡œ 16', cap:152, earthquake:'O', tel:'044-862-1082' },
        { id:7, area:'ì¡°ì¹˜ì›', name:'ì‹ ë´‰ì´ˆë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ì„œë¶ë¶€ë¡œ 10', cap:262, earthquake:'O', tel:'044-902-1482' },
        { id:8, area:'ì¡°ì¹˜ì›', name:'ë²ˆì•”1ë¦¬ ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì êµ°ì²­ë¡œ 11', cap:19, earthquake:'X', tel:'044-301-5172' },
        { id:9, area:'ì¡°ì¹˜ì›', name:'ì„œì°½2ë¦¬ ë‘ì§„(ì•„)ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ëª¨ê³¼ë‚˜ë¬´ê¸¸ 31', cap:23, earthquake:'X', tel:'044-301-5172' },
        { id:10, area:'ì¡°ì¹˜ì›', name:'ì„¸ì¢…eí¸í•œì„¸ìƒì•„íŒŒíŠ¸ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ì„­ê³¨ê¸¸ 59', cap:66, earthquake:'X', tel:'044-301-5172' },
        { id:11, area:'ì¡°ì¹˜ì›', name:'ì‹ ì•ˆ2ë¦¬ ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ì•ˆí„°ê¸¸ 83', cap:19, earthquake:'X', tel:'044-301-5172' },
        { id:12, area:'ì¡°ì¹˜ì›', name:'ì‹ í¥eí¸í•œì„¸ìƒê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ì´í™”1ë¡œ 15', cap:19, earthquake:'X', tel:'044-301-5172' },
        { id:13, area:'ì¡°ì¹˜ì›', name:'ì‹ í¥ì£¼ê³µì•„íŒŒíŠ¸ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ì´í™”ë¡œ 5', cap:54, earthquake:'X', tel:'044-301-5172' },
        { id:14, area:'ì¡°ì¹˜ì›', name:'ì‹ í¥í‘¸ë¥´ì§€ì˜¤ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ë„ì›1ë¡œ 16', cap:26, earthquake:'X', tel:'044-301-5172' },
        { id:15, area:'ì¡°ì¹˜ì›', name:'ìì´ì•„íŒŒíŠ¸ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ë„ì›ë¡œ 16', cap:62, earthquake:'X', tel:'044-301-5172' },
        { id:16, area:'ì¡°ì¹˜ì›', name:'ì¡°í˜•ì•„íŒŒíŠ¸ê²½ë¡œë‹¹', addr:'ì¡°ì¹˜ì›ì ìš´ì£¼ì‚°ë¡œ 60', cap:13, earthquake:'X', tel:'044-301-5172' },
        { id:17, area:'ì¡°ì¹˜ì›', name:'ë‚¨ë¦¬ë§ˆì„íšŒê´€', addr:'ì¡°ì¹˜ì›ì ì¥ì•ˆë¡œ 37', cap:26, earthquake:'X', tel:'044-301-5172' },
        { id:18, area:'ì¡°ì¹˜ì›', name:'ì„¸ì¢…ê³ ë“±í•™êµ', addr:'ì¡°ì¹˜ì›ì ì¡°ì¹˜ì›ì¤‘ê³ ê¸¸ 10', cap:411, earthquake:'X', tel:'044-320-6705' },
        { id:19, area:'ì¡°ì¹˜ì›', name:'ì„¸ì¢…ì¤‘í•™êµ', addr:'ì¡°ì¹˜ì›ì ìƒˆë‚´ë¡œ 160', cap:231, earthquake:'X', tel:'044-850-6682' },
        { id:20, area:'ì—°ë™', name:'ì—°ë™ë©´ ë³µí•©ì»¤ë®¤ë‹ˆí‹°ì„¼í„°', addr:'ì—°ë™ë©´ ì¥ìš±ë¡œ 7', cap:195, earthquake:'O', tel:'044-301-5344' },
        { id:21, area:'ì—°ë™', name:'ì—°ë™ì¤‘í•™êµ', addr:'ì—°ë™ë©´ ë‚´íŒë¡œ 10-13', cap:320, earthquake:'O', tel:'044-864-7021' },
        { id:22, area:'ì—°ë™', name:'ì—°ë™ì´ˆë“±í•™êµ', addr:'ì—°ë™ë©´ ì²­ì—°ë¡œ 606-36', cap:119, earthquake:'O', tel:'044-864-9380' },
        { id:23, area:'ì—°ë™', name:'ë‚´íŒ4ë¦¬ ë§ˆì„íšŒê´€', addr:'ì—°ë™ë©´ ìƒˆë§ë‹¤ë³µë™ê¸¸ 31-9', cap:27, earthquake:'X', tel:'044-301-5344' },
        { id:24, area:'ì—°ë™', name:'ëª…í•™2ë¦¬ ë§ˆì„íšŒê´€', addr:'ì—°ë™ë©´ íƒœì‚°ë¡œ 88-12', cap:15, earthquake:'X', tel:'044-301-5344' },
        { id:25, area:'ì—°ë™', name:'ë¬¸ì£¼ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ë™ë©´ ê°„ë§ê¸¸ 6', cap:30, earthquake:'X', tel:'044-301-5344' },
        { id:26, area:'ì—°ë™', name:'ì˜ˆì–‘2ë¦¬ ë§ˆì„íšŒê´€', addr:'ì—°ë™ë©´ ê°•ë³€ê¸¸ 119-1', cap:30, earthquake:'X', tel:'044-301-5344' },
        { id:27, area:'ì—°ë™', name:'ì‘ì•”2ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ë™ë©´ ì‘ì•”ë…¸ê³¡ê¸¸ 2', cap:28, earthquake:'X', tel:'044-301-5344' },
        { id:28, area:'ë¶€ê°•', name:'ë¶€ê°•ë©´ì‚¬ë¬´ì†Œ', addr:'ë¶€ê°•ë©´ ë¶€ê°•5ê¸¸ 38', cap:91, earthquake:'X', tel:'044-301-5442' },
        { id:29, area:'ë¶€ê°•', name:'ë¶€ê°•ì¤‘í•™êµ', addr:'ë¶€ê°•ë©´ ë¶€ê°•ë¡œ 25-7', cap:443, earthquake:'O', tel:'044-275-4081' },
        { id:30, area:'ë¶€ê°•', name:'ë¶€ê°•ì´ˆë“±í•™êµ', addr:'ë¶€ê°•ë©´ ë¶€ê°•ë¡œ 15', cap:326, earthquake:'O', tel:'044-902-1672' },
        { id:31, area:'ë¶€ê°•', name:'ì„¸ì¢…ë¯¸ë˜ê³ ë“±í•™êµ', addr:'ë¶€ê°•ë©´ ë¬¸ê³¡ë‹¬ë¯¸ê¸¸ 6', cap:308, earthquake:'O', tel:'044-275-4092' },
        { id:32, area:'ë¶€ê°•', name:'ë“±ê³¡1ë¦¬ê²½ë¡œë‹¹', addr:'ë¶€ê°•ë©´ ë“±ê³¡1ê¸¸ 160-22', cap:23, earthquake:'X', tel:'044-301-5442' },
        { id:33, area:'ë¶€ê°•', name:'ë¶€ê°•6ë¦¬ë§ˆì„íšŒê´€', addr:'ë¶€ê°•4ê¸¸ 28', cap:42, earthquake:'X', tel:'044-301-5442' },
        { id:34, area:'ë¶€ê°•', name:'ë¶€ê°•4,5ë¦¬ë§ˆì„íšŒê´€', addr:'ë¶€ì´Œê¸¸ 12-1', cap:42, earthquake:'X', tel:'044-301-5442' },
        { id:35, area:'ë¶€ê°•', name:'ë¶€ê°•3ë¦¬ë§ˆì„íšŒê´€', addr:'ë¶€ê°•5ê¸¸ 11', cap:115, earthquake:'X', tel:'044-301-5442' },
        { id:36, area:'ì—°ì„œ', name:'ì—°ì„œë©´ì‚¬ë¬´ì†Œ', addr:'ì—°ì„œë©´ ëŒ€ì²©ë¡œ 238', cap:61, earthquake:'O', tel:'044-301-5743' },
        { id:37, area:'ì—°ì„œ', name:'ì„¸ì¢…ë„ì›ì´ˆë“±í•™êµ', addr:'ì—°ì„œë©´ ë„ì›ë¡œ 63', cap:166, earthquake:'O', tel:'044-960-8607' },
        { id:38, area:'ì—°ì„œ', name:'ìŒë¥˜ì´ˆë“±í•™êµ', addr:'ì—°ì„œë©´ ë³„ë°œê¸¸ 73', cap:325, earthquake:'O', tel:'044-863-1929' },
        { id:39, area:'ì—°ì„œ', name:'ì—°ë´‰ì´ˆë“±í•™êµ', addr:'ì—°ì„œë©´ ë‹¹ì‚°ë¡œ 357-1', cap:278, earthquake:'O', tel:'044-867-7024' },
        { id:40, area:'ì—°ì„œ', name:'ì—°ì„œì¤‘í•™êµ', addr:'ì—°ì„œë©´ ì—°ì„œë¡œ 115', cap:346, earthquake:'O', tel:'044-902-0905' },
        { id:41, area:'ì—°ì„œ', name:'ì—°ì„œì´ˆë“±í•™êµ', addr:'ì—°ì„œë©´ ì—°ì„œë¡œ 148', cap:227, earthquake:'O', tel:'044-867-7024' },
        { id:42, area:'ì—°ì„œ', name:'ê³ ë³µ1ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ ë„ì‹ ê³ ë³µë¡œ 1061', cap:18, earthquake:'X', tel:'044-301-5743' },
        { id:43, area:'ì—°ì„œ', name:'êµ­ì´Œ2ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ í•¨ë°•ë¡œ 130', cap:18, earthquake:'X', tel:'044-301-5743' },
        { id:44, area:'ì—°ì„œ', name:'ë¶€ë™ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ ìš©ì—°ë¡œ 853', cap:32, earthquake:'X', tel:'044-301-5743' },
        { id:45, area:'ì—°ì„œ', name:'ìŒì „ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ í°ì°½ê³ ê°œê¸¸ 3-3', cap:11, earthquake:'X', tel:'044-301-5743' },
        { id:46, area:'ì—°ì„œ', name:'ì™€ì´Œ1ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ ìš©ì—°ë¡œ 759', cap:10, earthquake:'X', tel:'044-301-5743' },
        { id:47, area:'ì—°ì„œ', name:'ì›”í•˜1ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ ëŒ€ì²©ë¡œ 204', cap:44, earthquake:'X', tel:'044-301-5743' },
        { id:48, area:'ì—°ì„œ', name:'ì›”í•˜2ë¦¬ë§ˆì„íšŒê´€', addr:'ì—°ì„œë©´ ì‘ì€ì°½ê³ ê°œê¸¸ 16-3', cap:10, earthquake:'X', tel:'044-301-5743' },
        { id:49, area:'ì „ì˜', name:'ì „ì˜ë©´ ë³µí•©ì»¤ë®¤ë‹ˆí‹°ì„¼í„°', addr:'ìš´ì£¼ì‚°ë¡œ 1276(ì „ì˜ë©´)', cap:223, earthquake:'O', tel:'044-301-5844' },
        { id:50, area:'ì „ì˜', name:'ì „ì˜ì¤‘í•™êµ', addr:'ì „ì˜ë©´ ìš´ì£¼ì‚°ë¡œ 1260-6', cap:376, earthquake:'O', tel:'044-863-3201' },
        { id:51, area:'ì „ì˜', name:'ì „ì˜ì´ˆë“±í•™êµ', addr:'ì „ì˜ë©´ ìš´ì£¼ì‚°ë¡œ 1204-9', cap:223, earthquake:'O', tel:'044-863-1450' },
        { id:52, area:'ì „ì˜', name:'ê´€ì •1ë¦¬ êµ°ëŸ‰ê³¨ê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ êµ°ëŸ‰ê³¨ê¸¸ 48', cap:25, earthquake:'X', tel:'044-301-5844' },
        { id:53, area:'ì „ì˜', name:'ë‹¬ì„±í•™êµ¬ ê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ ì••ì‹¤ê¸¸ 2', cap:16, earthquake:'X', tel:'044-301-5844' },
        { id:54, area:'ì „ì˜', name:'ë‹¬ì „1ë¦¬ ê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ ìœ—ë‹¤ë½ê³¨ê¸¸ 46', cap:21, earthquake:'X', tel:'044-301-5844' },
        { id:55, area:'ì „ì˜', name:'ì‹ í¥ë¦¬ ê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ ì‚¬ì‹œë¦¬ê¸¸ 34', cap:25, earthquake:'X', tel:'044-301-5844' },
        { id:56, area:'ì „ì˜', name:'ìœ ì²œ1ë¦¬ê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ ì˜¤ë¥˜ê³¨ê¸¸ 112', cap:23, earthquake:'X', tel:'044-301-5844' },
        { id:57, area:'ì „ì˜', name:'ìë‚´1ë¦¬ í• ë¨¸ë‹ˆê²½ë¡œë‹¹', addr:'ì „ì˜ë©´ ë¶ì–‘ì²œê¸¸ 5', cap:21, earthquake:'X', tel:'044-301-5844' },
        { id:58, area:'ì „ì˜', name:'ì „ì˜ë©´ì‚¬ë¬´ì†Œ', addr:'ì „ì˜ë©´ ìš´ì£¼ì‚°ë¡œ 1270', cap:71, earthquake:'X', tel:'044-301-5844' },
        { id:59, area:'ì „ë™', name:'ì „ë™ë©´ ë³µí•©ì»¤ë®¤ë‹ˆí‹°ì„¼í„°', addr:'ìš´ì£¼ì‚°ë¡œ 386(ì „ë™ë©´)', cap:294, earthquake:'O', tel:'044-301-5944' },
        { id:60, area:'ì „ë™', name:'ì „ë™ì´ˆë“±í•™êµ', addr:'ì „ë™ë©´ í•˜ë…¸ì¥3ê¸¸ 9', cap:153, earthquake:'O', tel:'044-863-1209' },
        { id:61, area:'ì „ë™', name:'ì „ë™ë¶„íšŒ ê²½ë¡œë‹¹', addr:'ì „ë™ë©´ í•˜ë…¸ì¥1ê¸¸ 35', cap:28, earthquake:'X', tel:'044-301-5944' },
        { id:62, area:'ì „ë™', name:'ë¯¸ê³¡1ë¦¬ ë§ˆì„íšŒê´€', addr:'ì „ë™ë©´ ìš´ì£¼ì‚°ë¡œ 946-2', cap:30, earthquake:'X', tel:'044-301-5944' },
        { id:63, area:'ì „ë™', name:'ë´‰ëŒ€ë¦¬ ë§ˆì„íšŒê´€', addr:'ì „ë™ë©´ ë´‰ëŒ€2ê¸¸ 17', cap:23, earthquake:'X', tel:'044-301-5944' },
        { id:64, area:'ì „ë™', name:'ì†¡ì„±3ë¦¬ë§ˆì„íšŒê´€', addr:'ì „ë™ë©´ ì„±ê³¡ìƒˆë§ê¸¸ 14-19', cap:78, earthquake:'O', tel:'044-301-5944' },
        { id:65, area:'ì†Œì •', name:'ì†Œì •ë©´ì‚¬ë¬´ì†Œ', addr:'ì†Œì •ë©´ ì†Œì •êµ¬ê¸¸ 204', cap:50, earthquake:'X', tel:'044-301-6044' },
        { id:66, area:'ì†Œì •', name:'ì†Œì •ì´ˆë“±í•™êµ', addr:'ì†Œì •ë©´ í•™êµë§ê¸¸ 10', cap:185, earthquake:'O', tel:'044-566-6064' },
        { id:67, area:'ì†Œì •', name:'ì†Œì •ë©´ ë§¹ê³¨ê²½ë¡œë‹¹', addr:'ì†Œì •ë©´ ë§¹ê³¨1ê¸¸ 13-4', cap:23, earthquake:'X', tel:'044-301-6044' },
        { id:68, area:'ì†Œì •', name:'ì†Œì •ë©´ ì†Œì •1ë¦¬ ê²½ë¡œë‹¹', addr:'ì†Œì •ë©´ í•™êµë§ê¸¸ 1', cap:29, earthquake:'X', tel:'044-301-6044' },
        { id:69, area:'ì†Œì •', name:'ì†Œì •ë©´ ìš´ë‹¹2ë¦¬ ê²½ë¡œë‹¹', addr:'ì†Œì •ë©´ ìš´ë‹¹ë„˜ì–´ë§ê¸¸ 29', cap:25, earthquake:'X', tel:'044-301-6044' }
    ];

    window.onload = () => {
        renderShelter('ì „ì²´');
        fetchDetailRain();
        autoFetchSpecial();
    };

    function renderShelter(filterArea) {
        const container = document.getElementById('shelter-list');
        container.innerHTML = '';
        const filtered = filterArea === 'ì „ì²´' ? shelterData : shelterData.filter(s => s.area === filterArea);
        
        filtered.forEach(s => {
            const div = document.createElement('div');
            div.className = 'shelter-card';
            div.innerHTML = `
                <div>
                    <span class="shelter-tag tag-blue">${s.area}</span>
                    <div class="shelter-name">${s.name}</div>
                </div>
                <div class="shelter-info">ğŸ“ ${s.addr}</div>
                <div class="shelter-detail">
                    ìˆ˜ìš©ì¸ì›: <b>${s.cap}ëª…</b> | ë‚´ì§„: ${s.earthquake}<br>
                    ì—°ë½ì²˜: <a href="tel:${s.tel}" class="tel-link">${s.tel}</a>
                </div>
            `;
            container.appendChild(div);
        });
    }

    function filterShelter(area, btn) {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderShelter(area);
    }

    function toggleSection(id) { document.getElementById(id).classList.toggle('open'); }

    // ë‚ ì”¨/íŠ¹ë³´ (ê¸°ì¡´ ë¡œì§)
    async function fetchDetailRain() {
        const locs = [{ name: 'ì¡°ì¹˜ì›', lat: 36.601, lon: 127.301 }, { name: 'ì—°ì„œ', lat: 36.56, lon: 127.27 }, { name: 'ì „ì˜', lat: 36.67, lon: 127.2 }, { name: 'ì „ë™', lat: 36.63, lon: 127.26 }, { name: 'ì†Œì •', lat: 36.72, lon: 127.15 }, { name: 'ë¶€ê°•', lat: 36.52, lon: 127.37 }, { name: 'ì—°ë™', lat: 36.56, lon: 127.32 }];
        try {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${locs.map(l=>l.lat).join(',')}&longitude=${locs.map(l=>l.lon).join(',')}&daily=precipitation_sum&timezone=Asia%2FTokyo`;
            const res = await fetch(url); const data = await res.json();
            let total = 0; let html = '';
            data.forEach((r, i) => { const rain = r.daily.precipitation_sum[0] || 0; total += rain; html += `<div class="rain-cell"><div>${locs[i].name}</div><div style="color:${rain>0?'#0a84ff':'#fff'}">${rain}mm</div></div>`; });
            document.getElementById('rain-grid').innerHTML = html;
            document.getElementById('avg-rain-val').innerText = (total/locs.length).toFixed(1) + " mm";
        } catch(e) {}
    }

    async function autoFetchSpecial() {
        try {
            const proxyUrl = 'https://api.codetabs.com/v1/proxy?quest=' + encodeURIComponent('https://www.weatheri.co.kr/special/special01.php');
            const res = await fetch(proxyUrl); const text = await res.text();
            const parser = new DOMParser(); const doc = parser.parseFromString(text, 'text/html');
            const body = doc.body.innerText;
            const lines = body.split('\n'); const uniqueSet = new Set();
            lines.forEach(l => { if(l.trim().startsWith('o') && (l.includes('ì£¼ì˜ë³´') || l.includes('ê²½ë³´'))) uniqueSet.add(l.trim()); });
            document.getElementById('monitor-content').innerHTML = `<div style="font-size:12px; line-height:1.6;">${Array.from(uniqueSet).join('<br>')}</div>`;
        } catch(e) {}
    }
</script>
</body>
</html>
